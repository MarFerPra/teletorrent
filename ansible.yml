---
- hosts: default
  remote_user: marco
  become: true
  vars:
   BOT_TOKEN: "{{ lookup('env','BOT_TOKEN') }}"
   DB_PASSWORD: "{{ lookup('env','DB_PASSWORD')}}"
   DB_USER: "{{ lookup('env','DB_USER')}}"
   DB_USER: "{{ lookup('env','NODE_ENV')}}"
  tasks:
  - name: Updating repositories
    command: apt-get update
  - name: Installing essential libs
    command: apt-get install -y build-essential
  - name: Installing git
    command: apt-get install -y git
  - name: Installing pip
    command: apt-get install -y python-pip
  - name: Update pip
    command: pip install --upgrade pip
  - name: Add node repository
    apt_repository: url=https://deb.nodesource.com/setup_6.x dest=./setup_6.x mode=0550
  - name: Ejecutar script de instalaci√≥n de Node
    command: ./setup_6.x
  - name: Instalar Node
    apt: name=nodejs state=present
  - name: Updating npm
    command: npm install npm@latest -g
  - name: Cloning project repository
    shell: git clone https://github.com/MarFerPra/teletorrent
  - name: Installing Teletorrent dependencies
    command: cd teletorrent
    command: npm install --silent
